# Movie Gen: A Cast of Media Foundation Models

:::info[相关资料]

Meta 官方博客：https://ai.meta.com/blog/movie-gen-media-foundation-models-generative-ai-video/

Meta 官方技术报告：https://ai.meta.com/static-resource/movie-gen-research-paper

:::

## 主要功能展示

Meta Movie Gen 可以实现具有同步音频的视频生成、个性化角色的视频生成并支持视频编辑。

Movie Gen 实现的主要功能来自于提出的两个 foundation model，分别为 Movie Gen Video 以及 Movie Gen Audio。

- Movie Gen Video：30B 参数的大模型，支持 T2I 以及 T2V 的联合生成，最高可根据输入的文本提示生成 16 秒的 1080P HD 视频。
- Movie Gen Audio：13B 参数的大模型，支持 V2A 以及 T2A，最高可根据输入的视频以及文本提示生成 48kHz 的高质量同步音频。

### Text-to-Video 视频生成

<video width="100%" height="100%" autoplay loop controls>
    <source src="https://video-xsp1-2.xx.fbcdn.net/o1/v/t2/f2/m69/AQPiVwlpt0o56n5kQnldQ-we0lKIfuMSlf2lM95Qmas72Go9TJysToEl6buU1jqT1QnEVTAizFxQpbhKHlJiFJiY.mp4?efg=eyJ2ZW5jb2RlX3RhZyI6Im9lcF9oZCJ9&_nc_ht=video-xsp1-2.xx.fbcdn.net&_nc_cat=107&strext=1&vs=3d8ab693f43fa921&_nc_vs=HBksFQIYOnBhc3N0aHJvdWdoX2V2ZXJzdG9yZS9HQWJwaHh2aWozQmFxeUVEQU1kUnNVTmt2RUl6Ym1kakFBQUYVAALIAQAVAhg6cGFzc3Rocm91Z2hfZXZlcnN0b3JlL0dPbVJoaHNvYTdpRHk4TURBQkVSZVhnUTJkSlhickZxQUFBRhUCAsgBAEsHiBJwcm9ncmVzc2l2ZV9yZWNpcGUBMQ1zdWJzYW1wbGVfZnBzABB2bWFmX2VuYWJsZV9uc3ViACBtZWFzdXJlX29yaWdpbmFsX3Jlc29sdXRpb25fc3NpbQAoY29tcHV0ZV9zc2ltX29ubHlfYXRfb3JpZ2luYWxfcmVzb2x1dGlvbgAddXNlX2xhbmN6b3NfZm9yX3ZxbV91cHNjYWxpbmcAEWRpc2FibGVfcG9zdF9wdnFzABUAJQAcjBdAAAAAAAAAABERAAAAJr7Mjd7xmusNFQIoAkMzGAt2dHNfcHJldmlldxwXQDob52yLQ5YYGWRhc2hfaDI2NC1iYXNpYy1nZW4yXzcyMHASABgYdmlkZW9zLnZ0cy5jYWxsYmFjay5wcm9kOBJWSURFT19WSUVXX1JFUVVFU1QbCogVb2VtX3RhcmdldF9lbmNvZGVfdGFnBm9lcF9oZBNvZW1fcmVxdWVzdF90aW1lX21zATAMb2VtX2NmZ19ydWxlB3VubXV0ZWQTb2VtX3JvaV9yZWFjaF9jb3VudAM5OTcRb2VtX2lzX2V4cGVyaW1lbnQADG9lbV92aWRlb19pZA81MjM1Mjk4MjA2MzY3ODQSb2VtX3ZpZGVvX2Fzc2V0X2lkDzM4ODk1MzMzNDI2ODM2MhVvZW1fdmlkZW9fcmVzb3VyY2VfaWQQMzg5NDkzMjEyNzQ2MjE3NRxvZW1fc291cmNlX3ZpZGVvX2VuY29kaW5nX2lkDzUzOTg0NDM1NTA4MjQxNw52dHNfcmVxdWVzdF9pZAAlAhwAJb4BGweIAXMEMTcwNQJjZAoyMDI0LTEwLTAzA3JjYgM5MDADYXBwBuinhumikQJjdBFDTVNfTUVESUFfTUFOQUdFUhNvcmlnaW5hbF9kdXJhdGlvbl9zCTI2LjEwOTQxNwJ0cxVwcm9ncmVzc2l2ZV9lbmNvZGluZ3MA&ccb=9-4&oh=00_AYCszJkcEKMLCeqWbFCBk5g-ZCs9Iy63w6lGSbQlp9tEPg&oe=6709790A&_nc_sid=1d576d&_nc_rid=299321509316915&_nc_store_type=1" type="video/mp4">
</video>

### 个性化视频

<video width="100%" height="100%" autoplay loop controls>
    <source src="https://video-xsp1-2.xx.fbcdn.net/o1/v/t2/f2/m69/AQOvFTvzMc4bgV0UnKk434s09calfDp_gjzyUeu1PT9805-esb4Ri0sObRJ-KI7JmOlqkTI-Q9jpRLi_oZufrdgL.mp4?efg=eyJ2ZW5jb2RlX3RhZyI6Im9lcF9oZCJ9&_nc_ht=video-xsp1-2.xx.fbcdn.net&_nc_cat=109&strext=1&vs=6855ae7eccaeae68&_nc_vs=HBksFQIYOnBhc3N0aHJvdWdoX2V2ZXJzdG9yZS9HRTNmaWh1cWd6XzFaczBOQUZLaXFrcmx6cjU1Ym1kakFBQUYVAALIAQAVAhg6cGFzc3Rocm91Z2hfZXZlcnN0b3JlL0dIWkxpeHNiT2pDSmM5OERBTmxnNThuMTVJWmZickZxQUFBRhUCAsgBAEsHiBJwcm9ncmVzc2l2ZV9yZWNpcGUBMQ1zdWJzYW1wbGVfZnBzABB2bWFmX2VuYWJsZV9uc3ViACBtZWFzdXJlX29yaWdpbmFsX3Jlc29sdXRpb25fc3NpbQAoY29tcHV0ZV9zc2ltX29ubHlfYXRfb3JpZ2luYWxfcmVzb2x1dGlvbgAddXNlX2xhbmN6b3NfZm9yX3ZxbV91cHNjYWxpbmcAEWRpc2FibGVfcG9zdF9wdnFzABUAJQAcjBdAAAAAAAAAABERAAAAJqyzz-av3twDFQIoAkMzGAt2dHNfcHJldmlldxwXQC-HrhR64UgYGWRhc2hfaDI2NC1iYXNpYy1nZW4yXzcyMHASABgYdmlkZW9zLnZ0cy5jYWxsYmFjay5wcm9kOBJWSURFT19WSUVXX1JFUVVFU1QbCogVb2VtX3RhcmdldF9lbmNvZGVfdGFnBm9lcF9oZBNvZW1fcmVxdWVzdF90aW1lX21zATAMb2VtX2NmZ19ydWxlB3VubXV0ZWQTb2VtX3JvaV9yZWFjaF9jb3VudAM5OTcRb2VtX2lzX2V4cGVyaW1lbnQADG9lbV92aWRlb19pZBA0MzMxOTcxNjgwMzYyMzgzEm9lbV92aWRlb19hc3NldF9pZBA4ODI4NTIxODU3MTYwNDkyFW9lbV92aWRlb19yZXNvdXJjZV9pZBAxMDQ4MzU2MzkzMTg0NDcwHG9lbV9zb3VyY2VfdmlkZW9fZW5jb2RpbmdfaWQQMjU4NTExOTI0ODU0MjQzNw52dHNfcmVxdWVzdF9pZAAlAhwAJb4BGweIAXMEOTU4OQJjZAoyMDI0LTEwLTAzA3JjYgM5MDADYXBwBuinhumikQJjdBFDTVNfTUVESUFfTUFOQUdFUhNvcmlnaW5hbF9kdXJhdGlvbl9zCDE1Ljc2NTc1AnRzFXByb2dyZXNzaXZlX2VuY29kaW5ncwA&ccb=9-4&oh=00_AYBxAm-MDVsX_8GtEyDxahhS6vwG2NEYpWkszJAApMFH3w&oe=67098AF0&_nc_sid=1d576d&_nc_rid=519931164051780&_nc_store_type=1" type="video/mp4">
</video>

### 视频精确编辑

<video width="100%" height="100%" autoplay loop controls>
    <source src="https://video-xsp1-2.xx.fbcdn.net/o1/v/t2/f2/m69/AQPADa5iZqEcmRQ9qzlM4unPbF35nZRKF9_l4ENCmQnjRtjlrmSUj3iaa_JcdqtpVhhJtS_1z5cY4OPR0X5hhsah.mp4?efg=eyJ2ZW5jb2RlX3RhZyI6Im9lcF9oZCJ9&_nc_ht=video-xsp1-2.xx.fbcdn.net&_nc_cat=108&strext=1&vs=c39330cf123af574&_nc_vs=HBksFQIYOnBhc3N0aHJvdWdoX2V2ZXJzdG9yZS9HTFhmaXh1cUhUa1BIRW9IQU9weWtGS2hGbmR3Ym1kakFBQUYVAALIAQAVAhg6cGFzc3Rocm91Z2hfZXZlcnN0b3JlL0dCeDZqQnRzWUs4U3lkUURBR3d6SzJVaXYzOTdickZxQUFBRhUCAsgBAEsHiBJwcm9ncmVzc2l2ZV9yZWNpcGUBMQ1zdWJzYW1wbGVfZnBzABB2bWFmX2VuYWJsZV9uc3ViACBtZWFzdXJlX29yaWdpbmFsX3Jlc29sdXRpb25fc3NpbQAoY29tcHV0ZV9zc2ltX29ubHlfYXRfb3JpZ2luYWxfcmVzb2x1dGlvbgAddXNlX2xhbmN6b3NfZm9yX3ZxbV91cHNjYWxpbmcAEWRpc2FibGVfcG9zdF9wdnFzABUAJQAcjBdAAAAAAAAAABERAAAAJqCVyY6TlIECFQIoAkMzGAt2dHNfcHJldmlldxwXQEGJul41P30YGWRhc2hfaDI2NC1iYXNpYy1nZW4yXzcyMHASABgYdmlkZW9zLnZ0cy5jYWxsYmFjay5wcm9kOBJWSURFT19WSUVXX1JFUVVFU1QbCogVb2VtX3RhcmdldF9lbmNvZGVfdGFnBm9lcF9oZBNvZW1fcmVxdWVzdF90aW1lX21zATAMb2VtX2NmZ19ydWxlB3VubXV0ZWQTb2VtX3JvaV9yZWFjaF9jb3VudAM5OTcRb2VtX2lzX2V4cGVyaW1lbnQADG9lbV92aWRlb19pZBAxMjk2ODQ3NjU4MzU3ODU3Em9lbV92aWRlb19hc3NldF9pZA84OTY2NTU5MDE4NDc2MDQVb2VtX3ZpZGVvX3Jlc291cmNlX2lkDzU2NTQ5NTEzOTQ3NjgxNhxvZW1fc291cmNlX3ZpZGVvX2VuY29kaW5nX2lkEDEwMzg0NDQ4ODQ2NDkxODYOdnRzX3JlcXVlc3RfaWQAJQIcACW-ARsHiAFzBDcyMzUCY2QKMjAyNC0xMC0wNANyY2IDOTAwA2FwcAbop4bpopECY3QRQ01TX01FRElBX01BTkFHRVITb3JpZ2luYWxfZHVyYXRpb25fcwkzNS4wNzY3MDgCdHMVcHJvZ3Jlc3NpdmVfZW5jb2RpbmdzAA&ccb=9-4&oh=00_AYAGuULjmCpQmV-vrwKfzdSXqaQiG44abmWhlu3yyk6USA&oe=6709B657&_nc_sid=1d576d&_nc_rid=133263937467898&_nc_store_type=1" type="video/mp4">
</video>

### 音频生成

<video width="100%" height="100%" autoplay loop muted controls>
    <source src="https://video-xsp1-2.xx.fbcdn.net/o1/v/t2/f2/m69/AQOpzEj_Z2RBkJ41rerEkfPgLmwqdJBSfXbrh42Q8udD2EN3kMqJdk_EBKDRWkqF07JkKjGNQcxpHtI84J3hefeh.mp4?efg=eyJ2ZW5jb2RlX3RhZyI6Im9lcF9oZCJ9&_nc_ht=video-xsp1-2.xx.fbcdn.net&_nc_cat=103&strext=1&vs=a6425d4ff01d627f&_nc_vs=HBksFQIYOnBhc3N0aHJvdWdoX2V2ZXJzdG9yZS9HQ3h3aHh0d1NSWk1xZFFCQUd6MV9nVkNWQndfYm1kakFBQUYVAALIAQAVAhg6cGFzc3Rocm91Z2hfZXZlcnN0b3JlL0dNd0NoaHVMR2pFN3lLMERBRjZGRldLNFBvbG1ickZxQUFBRhUCAsgBAEsHiBJwcm9ncmVzc2l2ZV9yZWNpcGUBMQ1zdWJzYW1wbGVfZnBzABB2bWFmX2VuYWJsZV9uc3ViACBtZWFzdXJlX29yaWdpbmFsX3Jlc29sdXRpb25fc3NpbQAoY29tcHV0ZV9zc2ltX29ubHlfYXRfb3JpZ2luYWxfcmVzb2x1dGlvbgAddXNlX2xhbmN6b3NfZm9yX3ZxbV91cHNjYWxpbmcAEWRpc2FibGVfcG9zdF9wdnFzABUAJQAcjBdAAAAAAAAAABERAAAAJtbZ5a_Ax_YBFQIoAkMzGAt2dHNfcHJldmlldxwXQD4HrhR64UgYGWRhc2hfaDI2NC1iYXNpYy1nZW4yXzcyMHASABgYdmlkZW9zLnZ0cy5jYWxsYmFjay5wcm9kOBJWSURFT19WSUVXX1JFUVVFU1QbCogVb2VtX3RhcmdldF9lbmNvZGVfdGFnBm9lcF9oZBNvZW1fcmVxdWVzdF90aW1lX21zATAMb2VtX2NmZ19ydWxlB3VubXV0ZWQTb2VtX3JvaV9yZWFjaF9jb3VudAM5OTcRb2VtX2lzX2V4cGVyaW1lbnQADG9lbV92aWRlb19pZA84OTYyNTA0NTIwNzg1NDUSb2VtX3ZpZGVvX2Fzc2V0X2lkEDEwNTI0NDA4MjYxNjQxODQVb2VtX3ZpZGVvX3Jlc291cmNlX2lkDzU0MjE4ODEzMTYyODY1MRxvZW1fc291cmNlX3ZpZGVvX2VuY29kaW5nX2lkEDEyMDA2MjgzNjc4MTEwOTMOdnRzX3JlcXVlc3RfaWQAJQIcACW-ARsHiAFzBDY2NDACY2QKMjAyNC0xMC0wMwNyY2IDOTAwA2FwcAbop4bpopECY3QRQ01TX01FRElBX01BTkFHRVITb3JpZ2luYWxfZHVyYXRpb25fcwUzMC4wMwJ0cxVwcm9ncmVzc2l2ZV9lbmNvZGluZ3MA&ccb=9-4&oh=00_AYC9juBXquGWIlhEZ5BBihwbyj1HfPYgiUNDhrjjzlwYhQ&oe=6709770A&_nc_sid=1d576d&_nc_rid=670838906233448&_nc_store_type=1" type="video/mp4">
</video>


## Movie Gen Video

###  Joint Image and Video Generation（图像视频联合生成）

Meta 提出了 Movie Gen Video 这个统一的大模型来同时完成 T2I 以及 T2V 任务，模型将静态图像视为视频中的一帧，从而进行图像和视频生成的联合训练，即 Joint Image and Video Generation，使得模型可以同时生成图像和视频。

作者认为视频数据较为复杂，文本图像对的训练数据可以更好地帮助模型提高泛化性能。

下图展示了图像和视频联合生成的 pipeline。

![image-20241010225513173](https://raw.githubusercontent.com/bonjour-npy/Image-Hosting-Service/main/typora_imagestypora_imagesimage-20241010225513173.png)

### 多阶段训练策略

为了提高训练效率和模型的扩展能力，作者采用了多阶段的训练过程。

- 首先是 T2I 预热训练阶段。作者发现直接从头训练图像视频联合生成模型 T2I/V 会导致拟合缓慢，因此首先单独对 T2I 模型进行训练，作为预热阶段，并且在预热训练在较低分辨率（256 px）上进行，可以在相同的计算开销上以更大的 batch size 训练更多的数据。

- 其次是图像视频联合生成模型 T2I/V 训练阶段。

  为了可以成功实现联合训练，作者双倍增加了的空间位置编码层（spatial positional embedding layers）来适应更丰富的宽高比，同时增加了更多的时间位置编码层（temporal positional embedding layers）来支持多帧数图像（视频）的输入。

  然后进行高分辨率的 T2I/V 联合训练。

  ![image-20241010223251874](https://raw.githubusercontent.com/bonjour-npy/Image-Hosting-Service/main/typora_imagestypora_imagesimage-20241010223251874.png)

- 在高质量的视频数据集上通过 Supervised Finetuing（监督微调，SFT）来优化生成质量。

- 最后可以后训练（Post Training）的方式来为 Movie Gen 增加个性化角色视频生成以及视频精确编辑等能力。

![image-20241010215842535](https://raw.githubusercontent.com/bonjour-npy/Image-Hosting-Service/main/typora_imagesimage-20241010215842535.png)

### TAE（Temporal AutoEncoder）

为了提高效率，作者提出了 TAE 模型将像素空间的视频和图像压缩到经过学习的时空压缩隐式空间（learned spatial-temporally compreseed latent space），并且学习从隐空间中生成视频。

![image-20241010230313008](https://raw.githubusercontent.com/bonjour-npy/Image-Hosting-Service/main/typora_imagesimage-20241010230313008.png)

#### TAE Architecture（TAE 结构）

TAE 的设计采用了 LDM 使用的 Image Encoder 结构并且在**时间维度**进行扩展：

1. **1D 时间卷积（Temporal Convolution）**：在每个二维空间卷积（2D spatial convolution）之后加入 1D 的时间卷积。这使得模型能够捕捉数据的时间变化特征，从而适应视频的帧间动态变化。

   在视频生成中，帧之间存在时间上的连续性，时间卷积通过沿时间维度进行卷积操作，使得模型能够从连续帧中提取时间相关的信息。每一帧不仅通过空间卷积捕捉其内容，还通过时间卷积捕捉其与前后帧之间的动态关系。这种操作通过引入 1D 卷积来进行，保证了时间维度上的特征捕获。

2. **1D 时间注意力机制（Temporal Attention）**：在每次空间注意力（spatial attention）之后加入 1D 的时间注意力机制，帮助模型更好地关注视频序列中不同时间点的重要特征。在每个 2D 的空间卷积之后加入了 1D 的时间卷机，在每个 2D 的空间注意力之后加入了 1D 的时间注意力。

   通过在空间注意力之后加入 1D 的时间注意力，模型可以更好地理解视频序列中的时间依赖关系，即哪些时间点的特征对最终生成结果至关重要。这种注意力机制使模型能够在生成过程中关注到不同帧之间的关键时刻，提高视频的生成质量。

在降采样过程中，模型采用**步长为 2 的卷积操作**对视频数据进行压缩，通过这种方式减少时间维度上的冗余信息。而在上采样过程中，模型使用最近邻插值法恢复时间维度的信息，再通过卷积来平滑和补充细节。这一过程保证了视频长度的灵活性，能够处理不同长度的视频序列。

在下采样中采用在时间维度进行有步长的卷积方式来完成可以使模型能够处理任意帧长度的视频，包括图像（单帧视频），下图展示了时间维度卷积下采样的流程以及计算。

![image-20241011090436354](https://raw.githubusercontent.com/bonjour-npy/Image-Hosting-Service/main/typora_imagesimage-20241011090436354.png)

#### Improvements to the Training Objective（损失函数的优化）

作者发现如果 TAE 使用经典的 VAE 损失函数（Reconstruction Loss、Discriminator Loss、Perceptual Loss）进行训练会在数据空间解码出的视频中出现伪影点，如下图所示。

在 Latent Code 中伪影点位置出现了方差较大的取值

![image-20241011095152080](https://raw.githubusercontent.com/bonjour-npy/Image-Hosting-Service/main/typora_imagesimage-20241011095152080.png)

### Training Objective（训练目标与损失函数）

### Joint Image and Video Generation Backbone Architecture（骨干网络）

### Rich Text Embedding and Visual-text Generation（丰富的文本嵌入以及视觉文本生成）

### Spatial Upsampling（空间上采样）



## Movie Gen Audio
